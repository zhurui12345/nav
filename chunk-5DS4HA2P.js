import{a as Ie,b as Ve,c as Ee,d as Ne}from"./chunk-RTVESSIG.js";import{w as ae}from"./chunk-V2QEHFQP.js";import{b as Me,d as be,e as Te}from"./chunk-CPJXRE3E.js";import{c as me,e as pe,f as _e}from"./chunk-ABZVYBNC.js";import{a as H,b as Q,c as q,d as U,f as Y,g as V}from"./chunk-MITZ4KB3.js";import{f as ye,i as Ce}from"./chunk-FS2Y7ZZ5.js";import"./chunk-JVALCBZP.js";import{a as xe,b as ze}from"./chunk-VTTQRYJ5.js";import{$b as fe,Lb as ue,Ob as de,Rb as ge,da as G,fa as J,mc as ve,nc as he,pc as Se,qc as we,ra as le,ta as se,ua as P,uc as ke,xa as ce}from"./chunk-IIHL3SUF.js";import{$b as w,Bc as d,Cb as f,Cc as b,Ce as h,Dc as g,Ed as T,Fb as B,Hc as C,Ic as x,Jc as z,Md as I,Sd as k,Yb as a,Yd as X,Zb as c,Zd as L,_b as s,ce as Z,dc as $,ec as A,fe as ee,gc as y,ge as te,h as R,ib as W,ie as ne,jc as _,je as ie,ke as oe,lb as n,le as O,mc as r,ne as v,qb as S,qc as j,qe as re,rc as K,sc as F,wb as M,xa as m,ya as p,yc as N}from"./chunk-A5Z46WWS.js";var Re=["input"];function We(i,l){if(i&1){let e=y();c(0,"div",6)(1,"input",7),z("ngModelChange",function(t){m(e);let u=r(2);return x(u.imageToken,t)||(u.imageToken=t),p(t)}),_("keyup",function(t){m(e);let u=r(2);return p(u.onKey(t))}),s()()}if(i&2){let e=r(2);n(),C("ngModel",e.imageToken)}}function Be(i,l){if(i&1&&(c(0,"p",8),d(1),c(2,"a",9),d(3),s()()),i&2){let e=r(2);n(),g(" ",e.$t("_getToken")),n(2),g(" ",e.$t("_readDoc"))}}function $e(i,l){if(i&1){let e=y();$(0),c(1,"p"),d(2),s(),c(3,"input",3,0),z("ngModelChange",function(t){m(e);let u=r();return x(u.token,t)||(u.token=t),p(t)}),_("keyup",function(t){m(e);let u=r();return p(u.onKey(t))}),s(),f(5,We,2,1,"div",4)(6,Be,4,2,"p",5),A()}if(i&2){let e=r();n(2),b(e.$t("_inputTokenMsg")),n(),C("ngModel",e.token),a("placeholder",e.isSelfDevelop?"Password":"Token"),n(2),a("ngIf",e.showImgToken),n(),a("ngIf",!e.isSelfDevelop)}}var E=class i{constructor(l,e){this.message=l;this.router=e;v||(this.showImgToken=se())}visible=!1;onCancel=new B;input;$t=h;isSelfDevelop=v;token="";imageToken="";submitting=!1;showImgToken=!1;ngAfterViewInit(){this.inputFocus()}handleCancel(){this.onCancel.emit(),this.router.navigate(["/"])}inputFocus(){setTimeout(()=>{this.input?.nativeElement?.focus()},500)}onKey(l){l.code==="Enter"&&this.login()}login(){return R(this,null,function*(){let l=this.token.trim();if(!l){this.message.error(h("_pleaseInputToken"));return}if(this.showImgToken){let e=this.imageToken.trim();if(!e){this.message.error("Please enter the image TOKEN");return}try{this.submitting=!0;let o=k.imageRepoUrl.split("/").at(-2),t=yield P(e,k.imageRepoUrl);if((t?.data?.login??t?.data?.username)!==o){this.message.error("Image Bad credentials");return}ne(e)}catch{}finally{this.submitting=!1}}this.submitting=!0;try{let e=yield P(l);if(!v&&(e?.data?.login??e?.data?.username)!==le)throw this.message.error("Bad credentials"),new Error("Bad credentials");ee(l);try{ce("image").finally(()=>{this.message.success(h("_tokenVerSuc")),ie().finally(()=>{window.location.reload()})})}catch{te(),this.submitting=!1}}catch{this.submitting=!1}})}static \u0275fac=function(e){return new(e||i)(S(ke),S(V))};static \u0275cmp=M({type:i,selectors:[["app-login"]],viewQuery:function(e,o){if(e&1&&j(Re,5),e&2){let t;K(t=F())&&(o.input=t.first)}},inputs:{visible:"visible"},outputs:{onCancel:"onCancel"},decls:2,vars:3,consts:[["input",""],[3,"nzVisibleChange","nzOnCancel","nzOnOk","nzVisible","nzTitle","nzOkLoading"],[4,"nzModalContent"],["nz-input","","autofocus","",3,"ngModelChange","keyup","ngModel","placeholder"],["class","mt-4",4,"ngIf"],["class","!mt-2",4,"ngIf"],[1,"mt-4"],["nz-input","","autofocus","","placeholder","Image token",3,"ngModelChange","keyup","ngModel"],[1,"!mt-2"],["href","https://github.com/xjh22222228/nav#%E9%83%A8%E7%BD%B2","target","_blank"]],template:function(e,o){e&1&&(c(0,"nz-modal",1),z("nzVisibleChange",function(u){return x(o.visible,u)||(o.visible=u),u}),_("nzOnCancel",function(){return o.handleCancel()})("nzOnOk",function(){return o.login()}),f(1,$e,7,5,"ng-container",2),s()),e&2&&(C("nzVisible",o.visible),a("nzTitle",o.$t("_authLogin"))("nzOkLoading",o.submitting))},dependencies:[I,T,fe,ue,de,ge,Te,be,Me,Ce,ye],styles:[".prefix-icon[_ngcontent-%COMP%]{width:20px;height:20px;pointer-events:none}"]})};function Ae(i,l){if(i&1){let e=y();c(0,"li",5),_("click",function(){m(e);let t=r(2);return p(t.goRoute("/system/component"))}),d(1),s()}if(i&2){let e=r(2);a("nzSelected",e.currentMenu==="component"),n(),g(" ",e.$t("_components")," ")}}function je(i,l){if(i&1){let e=y();c(0,"li",5),_("click",function(){m(e);let t=r(2);return p(t.goRoute("/system/bookmarkExport"))}),d(1),s()}if(i&2){let e=r(2);a("nzSelected",e.currentMenu==="bookmarkExport"),n(),g(" ",e.$t("_bookmarkExport")," ")}}function Ke(i,l){if(i&1){let e=y();c(0,"li",5),_("click",function(){m(e);let t=r(2);return p(t.goRoute("/system/collect"))}),d(1),s()}if(i&2){let e=r(2);a("nzSelected",e.currentMenu==="collect"),n(),g(" ",e.$t("_userCollect")," ")}}function Fe(i,l){if(i&1){let e=y();c(0,"li",5),_("click",function(){m(e);let t=r(2);return p(t.goRoute("/system/config"))}),d(1),s()}if(i&2){let e=r(2);a("nzSelected",e.currentMenu==="config"),n(),g(" ",e.$t("_confInfo")," ")}}function He(i,l){if(i&1){let e=y();c(0,"li",5),_("click",function(){m(e);let t=r(2);return p(t.goRoute("/system/info"))}),d(1),s()}if(i&2){let e=r(2);a("nzSelected",e.currentMenu==="info"),n(),g(" ",e.$t("_webInfo")," ")}}function Qe(i,l){if(i&1&&(c(0,"span",19),d(1),s()),i&2){let e=r(2);n(),b(e.date)}}function qe(i,l){i&1&&w(0,"nz-spin",20),i&2&&a("nzSize","large")}function Ue(i,l){if(i&1){let e=y();c(0,"nz-layout",2)(1,"nz-layout")(2,"nz-sider",3),z("nzCollapsedChange",function(t){m(e);let u=r();return x(u.isCollapsed,t)||(u.isCollapsed=t),p(t)}),c(3,"ul",4)(4,"li",5),_("click",function(){m(e);let t=r();return p(t.goRoute("/system/web"))}),d(5),s(),c(6,"li",5),_("click",function(){m(e);let t=r();return p(t.goRoute("/system/setting"))}),d(7),s(),c(8,"li",5),_("click",function(){m(e);let t=r();return p(t.goRoute("/system/tag"))}),d(9),s(),c(10,"li",5),_("click",function(){m(e);let t=r();return p(t.goRoute("/system/search"))}),d(11),s(),f(12,Ae,2,2,"li",6),c(13,"li",5),_("click",function(){m(e);let t=r();return p(t.goRoute("/system/bookmark"))}),d(14),s(),f(15,je,2,2,"li",6)(16,Ke,2,2,"li",6),c(17,"li",5),_("click",function(){m(e);let t=r();return p(t.goRoute("/system/auth"))}),d(18),s(),f(19,Fe,2,2,"li",6)(20,He,2,2,"li",6),s()(),c(21,"nz-layout",7)(22,"nz-content",8)(23,"div",9)(24,"button",10),_("click",function(){m(e);let t=r();return p(t.toggleCollapsed())}),w(25,"nz-icon",11),s(),c(26,"button",12),_("click",function(){m(e);let t=r();return p(t.goBack())}),d(27),s(),c(28,"button",13),_("click",function(){m(e);let t=r();return p(t.logout())}),d(29),s(),c(30,"img",14),_("error",function(t){m(e);let u=r();return p(u.imageErrorHidden(t))}),s(),c(31,"a",15)(32,"img",16),_("error",function(t){m(e);let u=r();return p(u.imageErrorHidden(t))}),s()(),f(33,Qe,2,1,"span",17),s(),f(34,qe,1,1,"nz-spin",18),w(35,"router-outlet"),s()()()()}if(i&2){let e=r();n(2),N("hide",e.isCollapsed),C("nzCollapsed",e.isCollapsed),a("nzTrigger",null),n(2),a("nzSelected",e.currentMenu==="web"),n(),g(" ",e.$t("_websiteMang")," "),n(),a("nzSelected",e.currentMenu==="setting"),n(),g(" ",e.$t("_systemSet")," "),n(),a("nzSelected",e.currentMenu==="tag"),n(),g(" ",e.$t("_tagSettings")," "),n(),a("nzSelected",e.currentMenu==="search"),n(),g(" ",e.$t("_searchEngines")," "),n(),a("ngIf",e.isAuthz||e.isSelfDevelop),n(),a("nzSelected",e.currentMenu==="bookmark"),n(),g(" ",e.$t("_bookmarkImport")," "),n(),a("ngIf",e.isAuthz),n(),a("ngIf",e.isAuthz||e.isSelfDevelop),n(),a("nzSelected",e.currentMenu==="auth"),n(),g(" ",e.$t("_vipAuth")," "),n(),a("ngIf",e.isSelfDevelop),n(),a("ngIf",!e.isSelfDevelop),n(),N("!ml-0",e.isCollapsed),n(4),a("nzType",e.isCollapsed?"menu-unfold":"menu-fold"),n(2),g(" ",e.$t("_backHome")," "),n(2),g(" ",e.$t("_logout")," "),n(),a("src",e.currentVersionSrc,W),n(3),a("ngIf",!e.isSelfDevelop),n(),a("ngIf",e.pageLoading)}}var D=class i{constructor(l){this.router=l;re(),this.router.events.subscribe(e=>{e instanceof H?this.pageLoading=!0:(e instanceof Q||e instanceof q||e instanceof U)&&(this.pageLoading=!1)})}isSelfDevelop=v;$t=h;isLogin=O;currentVersionSrc=`https://img.shields.io/badge/current-v${X}-red.svg?longCache=true&style=flat-square`;date=k.datetime;imageErrorHidden=ae;showLoginModal=!O;currentMenu="";isAuthz=!!Z();pageLoading=!1;isCollapsed=!!Number(localStorage.getItem(L.SYSTEM_COLLAPSED));ngOnInit(){let l=window.location.href.split("/");this.currentMenu=l.at(-1)||""}toggleCollapsed(){this.isCollapsed=!this.isCollapsed,localStorage.setItem(L.SYSTEM_COLLAPSED,String(Number(this.isCollapsed)))}goBack(){this.router.navigate(["/"],{queryParams:{_:Date.now()}})}goRoute(l,e=!1){e||this.router.navigate([l])}logout(){oe(),this.router.navigate(["/"]),setTimeout(()=>{location.reload()},26)}static \u0275fac=function(e){return new(e||i)(S(V))};static \u0275cmp=M({type:i,selectors:[["app-system"]],decls:2,vars:2,consts:[["class","system-layout",4,"ngIf"],[3,"visible"],[1,"system-layout"],["nzWidth","150px","nzTheme","light","nzCollapsible","",1,"sidebar","select-none",3,"nzCollapsedChange","nzCollapsed","nzTrigger"],["nz-menu","","nzMode","inline",1,"sider-menu"],["nz-menu-item","",3,"click","nzSelected"],["nz-menu-item","",3,"nzSelected","click",4,"ngIf"],[1,"inner-layout"],[1,"content"],[1,"whitespace-nowrap","overflow-x-auto","topbar"],["nz-button","","nzType","primary",3,"click"],[3,"nzType"],["nz-button","",2,"margin","0 15px 15px",3,"click"],["nz-button","","nzDanger","","nzType","primary",3,"click"],[1,"ml-2.5",3,"error","src"],["href","https://github.com/xjh22222228/nav/releases","target","_blank"],["src","https://img.shields.io/github/v/release/xjh22222228/nav",1,"ml-2.5",3,"error"],["class","ml-2.5",4,"ngIf"],["nzSimple","","class","fixed-center",3,"nzSize",4,"ngIf"],[1,"ml-2.5"],["nzSimple","",1,"fixed-center",3,"nzSize"]],template:function(e,o){e&1&&(f(0,Ue,36,29,"nz-layout",0),w(1,"app-login",1)),e&2&&(a("ngIf",o.isLogin),n(),a("visible",o.showLoginModal))},dependencies:[I,T,Ne,Ee,Ie,Ve,_e,pe,me,we,Se,ve,he,E,Y,ze,xe,J,G],styles:[".system-layout[_ngcontent-%COMP%]{min-height:100vh}.system-layout[_ngcontent-%COMP%]   .topbar[_ngcontent-%COMP%]{z-index:3;position:sticky;background-color:#fff;top:0;margin-bottom:10px;padding:15px 15px 0;box-shadow:0 5px 5px #0000000d}.system-layout[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]{padding:0 15px 15px;background-color:#fff;height:100vh;overflow:hidden;overflow-y:auto}.system-layout[_ngcontent-%COMP%]   .content[_ngcontent-%COMP%]     .ant-table-content{overflow:auto}.system-layout[_ngcontent-%COMP%]   .sidebar[_ngcontent-%COMP%]{position:sticky;top:0;background-color:#fff}.system-layout[_ngcontent-%COMP%]   .sidebar.hide[_ngcontent-%COMP%]{width:0!important;min-width:0!important;flex:0!important}.system-layout[_ngcontent-%COMP%]   .inner-layout[_ngcontent-%COMP%]{margin-left:15px}.system-layout[_ngcontent-%COMP%]   .fixed-center[_ngcontent-%COMP%]{position:fixed;top:50%;left:50%;transform:translate(-50%,-50%);z-index:10}"]})};export{D as default};
